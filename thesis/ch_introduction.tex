\chapter{引言}

\section{研究背景与意义}
联机分析处理(OLAP) \cite{chaudhuri1997overview} 是一种多维度的数据分析技术，能进行大规模数据的分析及统计计算，多用于决策支持系统和数据仓库。例如企业可分别从用户维度，产品维度以及订单维度来分析对于不同年龄阶层最受欢迎的产品类型，从而推出针对不同年龄的产品销售计划。由于企业数据的快速增长累积以及企业对分析历史数据、挖掘商业价值的热情逐渐增高，联机分析处理应用在业界变得越来越受欢迎，开发更高效的 OLAP 技术浪潮应运而生。

数据立方(Data cube) \cite{gray1997data}是由 Jim Gray 等人于 1996 年提出的，它是一种有效支持 OLAP 应用的多维数据计算模型，是 OLAP 领域中的一项关键技术。它提出通过预先计算数据表中各属性间的所有组合对应的 GroupBy 结果并存储起来，以缩短系统的查询响应时间从而提高应用效率。该模型的核心思想是利用各个GroupBy组合之间的关系进行计算，从而提高计算效率。在现实应用中，数据立方的高效计算是实例化数据立方的关键。 \cite{agarwal1996computation} \cite{beyer1999bottom} 是较为流行的数据立方计算方法。根据不同角度与不同场景，业界一直在探讨数据立方计算的优化 \cite{xin2003star} \cite{harinarayan1996implementing} \cite{zhao1997array} \cite{han2001efficient} \cite{wang2002condensed}。\cite{ng2001iceberg} \cite{dehne2002parallelizing} 还提出了在小集群上的并行数据立方计算的方法。但随着数据量的急剧增长，单机和小集群上数据立方的计算方法已无法满足数据立方的计算要求。


面对惊人的计算量，选择大量廉价的计算机组成一个分布式计算系统，是一个能够在满足时间和成本代价的基础上解决计算难题的办法。谷歌提出了 MapReduce \cite{dean2008mapreduce}分布式计算框架。随着 Hadoop \cite{hadoop}开源项目的发展，MapReduce 已成为目前业界流行的分布式计算框架，它具有高度的集群稳定性及高效的规模扩展性。它不仅在处理非结构化数据上有卓越的表现，业界还不断扩展它处理结构化数据的能力 \cite{hbase} \cite{abouzeid2009hadoopdb} \cite{buck2011scihadoop} \cite{pig} \cite{hive}。因此探索如何在分布式计算框架MapReduce下高效地完成数据立方的计算成为势在必行的一个趋势
 \cite{abello2011building} \cite{wang2010mapreducemerge} \cite{sergey2009applying} \cite{lee2012efficient} \cite{wang2013scalable}。


%随着数据的爆炸性增长，传统的对数据处理计算分析的方法已无法满足当前的需求。仅仅将传统算法与分布式机械地结合，并不能充分利用两者各自的优势。\cite{cuzzocrea2011analytics} \cite{cuzzocrea2013data} \cite{cuzzocrea2013big} 中提出了一些由于数据增长给数据仓库、OLAP 带来的挑战，其中包括大数据的存储与分布、可扩展问题、ETL过程、多维数据的建模、分析、查询等等。
%数据立方是 OLAP 领域内一项关键技术，数据立方的高效计算可大幅度提高 OLAP 对查询的相应时间随着数据的急剧增加，


Raghu Ramakrishnan 团队提出的 MapReduce DataCube 方案 \cite{nandi2012data} \cite{nandi2011distributed}（以下简称MR-Cube），是当前 MapReduce 与数据立方的最佳结合。MR-Cube解决了整体性度量与函数MapReduce的结合、数据划分、中间数据过多、合并计算等问题。虽然它实现了数据立方与 MapReduce 的高效结合，但其仍存在缺陷，尤其是在一些倾斜的数据集下，其对数据划分的方法会产生不必要的划分。因此对于倾斜数据的均匀划分，应使用更好的划分方法，令数据划分适用于更多的场景。同时它对计算的合并只给出了一些建议遵循的规则，并没有给出具体的简单有效的合并方法。此外，MR-Cube 使用了 BUC \cite{beyer1999bottom} 的算法计算 MapReduce 下的数据立方。然而数据立方的实现技术除了 BUC 外，还有 PipeSort，PipeHash \cite{agarwal1996computation} 等。这些方法与 BUC 相比，更能利用 MapReduce 框架的一些特性。所以可尝使用其他数据立方的实现方法来取代 BUC，从而优化 MR-Cube、整合 MapReduce 与其他数据立方技术。


%如 HBase \cite{hbase}，一种基于 Hadoop 的面向列存储的数据库，是一个结构化数据的分布式存储系统。它利用 HDFS 为其提供高可靠的底层存储支持，利用 MapReduce 为其提供高性能的计算能力，能够快速的定位并访问存储于 HDFS 上数十亿行的数据，同时还可利用 Pig \cite{pig} 或 Hive \cite{hive} 为其提供高层语言支持。



%如前雅虎搜索与运计算首席科学家，现微软技术会士 Raghu Ramakrishnan 则带领其团队进行 Data Cube 与 MapReduce 的技术整合，提出了 MR-Cube 方案 \cite{nandi2012data} \cite{nandi2011distributed}，针对 MapReduce 框架提出了 Data Cube 的实例化计算方法，并提出了 2 种 整体性度量在分布式计算下的解决方案。MR-Cube 的思想现也在 Pig 开源项目上进行实现 \cite{mrcubepig}。

%随着计算机的普及，计算机逐渐被各行各业用于复杂的数据计算。由于许多项目的数据计算量过大，复杂性过高，




\section{本文工作}


本文工作主要是探讨当前数据立方计算的研究现状，优化现有的基于 MapReduce 的 数据立方实现方案，主要是针对Raghu Ramakrishnan 团队提出的 MR-Cube 方案 \cite{nandi2012data} \cite{nandi2011distributed}，分析其优缺点，针对MR-Cube的不足以及可改进的地方，借鉴\cite{tao2013minimal} 中将TeraSort 与 GroupBy 结合的方法 以及 将 MapReduce 与 Pipesort 结合，提出了TSP-Cube 计算方法。TSP-Cube 使用 Tera Sort 的思想提出更具有通用性的对倾斜数据的划分方法；并且使用 Pipesort 替代 BUC 方法实现基于 MapReduce 的数据立方，从而更充分利用MapReduce框架的特性。同时，还针对层次型的数据集以及结合Pipesort的特征，提出Pipeline的生成方案。最后根据实验结果总结出两种不同类型的度量函数适用的计算方法， 从而为后续的MapReduce 与数据立方计算的优化实现提供研究经验支持。


本文的内容安排如下，第2章介绍与数据立方相关的基础知识，第3章探讨当前数据立方计算的研究现状，第4章具体地分析MR-Cube的的贡献以及不足，第5章提出TSP-Cube方法，并对其进行详细的理论分析，第6章阐述实验结果与结果分析，第7章为总结与展望。


